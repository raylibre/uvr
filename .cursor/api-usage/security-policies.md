# Політики безпеки УВР

## Загальний опис

Цей документ описує політики безпеки (Row Level Security) для системи Українського Військового Руху. Політики розроблені з урахуванням специфіки роботи з даними військовослужбовців та забезпечують максимальний захист конфіденційної інформації.

## Ролі користувачів

### Адміністратор (admin)
- Повний доступ до всіх таблиць
- Управління користувачами та їх ролями
- Перегляд аудиту системи
- Створення та управління проектами

### Модератор (moderator)
- Перегляд профілів користувачів
- Верифікація документів
- Обробка запитів на зміну категорії
- Обмежене управління заявками

### Координатор проекту (coordinator)
- Управління своїми проектами
- Перегляд та обробка заявок на свої проекти
- Обмежений доступ до профілів учасників

### Користувач (user)
- Управління власним профілем
- Подання заявок на проекти
- Перегляд активних проектів
- Доступ до власних документів

## Політики для таблиць

### Профілі користувачів (profiles)

1. **Перегляд профілю**
   - Користувач може бачити свій профіль
   - Адміністратори та модератори бачать всі профілі
   - Інші користувачі бачать базову інформацію верифікованих профілів

2. **Оновлення профілю**
   - Користувач може оновлювати свій профіль (крім ролі та верифікації)
   - Адміністратори можуть оновлювати будь-який профіль
   - Модератори можуть оновлювати тільки статус верифікації

### Запити на зміну категорії (category_change_requests)

1. **Перегляд запитів**
   - Користувач бачить тільки свої запити
   - Адміністратори та модератори бачать всі запити

2. **Створення та оновлення**
   - Користувач може створювати запити для себе
   - Користувач може оновлювати свої pending запити
   - Адміністратори та модератори можуть оновлювати статус запитів

### Документи категорій (category_documents)

1. **Доступ до документів**
   - Користувач бачить документи своїх запитів
   - Адміністратори та модератори бачать всі документи

2. **Управління документами**
   - Користувач може завантажувати документи до своїх запитів
   - Користувач може видаляти свої документи (тільки в статусі pending)
   - Адміністратори та модератори можуть верифікувати документи

### Проекти (projects)

1. **Перегляд проектів**
   - Всі користувачі бачать активні проекти
   - Адміністратори бачать всі проекти

2. **Управління проектами**
   - Адміністратори можуть створювати та управляти проектами
   - Координатори можуть оновлювати свої проекти

### Заявки на проекти (project_applications)

1. **Перегляд заявок**
   - Користувач бачить свої заявки
   - Адміністратори та координатори бачать заявки на свої проекти

2. **Управління заявками**
   - Користувач може створювати заявки для себе
   - Користувач може оновлювати свої чернетки
   - Адміністратори та координатори можуть оновлювати статус заявок

## Додаткові функції безпеки

### Допоміжні функції

1. **is_admin()**
   - Перевіряє права адміністратора
   - Використовується в політиках безпеки

2. **is_moderator()**
   - Перевіряє права модератора
   - Включає також адміністраторів

3. **is_verified_user()**
   - Перевіряє статус верифікації користувача
   - Використовується для доступу до певних функцій

4. **get_user_category()**
   - Повертає категорію користувача
   - Використовується для перевірки доступу до проектів

## Аудит та логування

### Таблиця аудиту (user_audit_log)

1. **Запис подій**
   - Автоматичне логування всіх важливих дій
   - Збереження старих та нових значень
   - Фіксація IP-адреси та User-Agent

2. **Доступ до логів**
   - Тільки адміністратори можуть переглядати логи
   - Система автоматично створює записи

## Рекомендації з безпеки

1. **Загальні правила**
   - Регулярна перевірка прав доступу
   - Моніторинг підозрілої активності
   - Періодичний аудит змін

2. **Робота з документами**
   - Перевірка типів файлів
   - Обмеження розміру файлів
   - Сканування на віруси

3. **Верифікація користувачів**
   - Перевірка достовірності документів
   - Підтвердження категорії
   - Моніторинг змін статусу

## Технічна підтримка

При виникненні проблем з безпекою:
1. Перевірте логи аудиту
2. Зверніться до технічної документації
3. Зв'яжіться з адміністратором системи

## Розвиток системи безпеки

Плановані покращення:
1. Двофакторна автентифікація
2. Розширена система аудиту
3. Автоматизація перевірки документів
4. Інтеграція з зовнішніми системами безпеки 